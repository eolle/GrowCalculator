<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz de Cultivo Cannabis Indoor - GrowCalculator</title>
    <style>
        :root {
            --green-dark: #2D5016;
            --green-darker: #1B4332;
            --green-medium: #40916C;
            --green-light: #52B788;
            --yellow-accent: #F59E0B;
            --yellow-accent-alt: #FF8500;
            --white: #FFFFFF;
            --gray-dark: #2D3748;
            --green-very-dark: #1A1A1A;
            --green-soft: #D8F3DC;
            --yellow-soft: #FFF3CD;
            --ocre-bg: #FFE5B4;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--ocre-bg);
            min-height: 100vh;
            padding: 20px;
            color: var(--gray-dark);
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        .quiz-header {
            text-align: center;
            color: var(--white);
            margin-bottom: 2rem;
        }
        .quiz-title {
            font-size: 2.8rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(45,80,22,0.10);
            color: var(--white);
        }
        .quiz-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 1rem;
            color: var(--gray-dark);
        }
        .quiz-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        .quiz-card {
            background: rgba(255,255,255,0.7);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(139,92,246,0.10);
            border: 3px solid transparent;
            backdrop-filter: blur(8px);
        }
        .quiz-card:hover {
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 15px 40px rgba(34,197,94,0.15);
            border-color: var(--yellow-accent);
        }
        .quiz-icon {
            font-size: 3.5rem;
            margin-bottom: 1rem;
        }
        .quiz-card h3 {
            font-size: 1.6rem;
            margin-bottom: 1rem;
            color: var(--yellow-accent);
            text-shadow: 0 1px 2px rgba(0,0,0,0.07);
        }
        .quiz-card.bg-light h3 {
            color: #111;
        }
        .quiz-card p {
            color: var(--gray-dark);
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }
        .quiz-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--gray-dark);
            border-top: 1px solid #eee;
            padding-top: 1rem;
        }
        .difficulty {
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            color: white;
            font-size: 0.8rem;
        }
        .difficulty.principiante { background: var(--green-light); color: var(--green-dark); }
        .difficulty.intermedio { background: var(--green-medium); color: var(--white); }
        .difficulty.avanzado { background: var(--yellow-accent); color: var(--green-dark); }
        .difficulty.experto { background: var(--green-dark); color: var(--white); }
        .quiz-container {
            background: rgba(255,255,255,0.7);
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 20px 50px rgba(139,92,246,0.10);
            display: none;
            backdrop-filter: blur(10px);
        }
        .quiz-info {
            background: var(--green-soft);
            border-left: 4px solid var(--green-medium);
            padding: 1rem;
            margin-bottom: 2rem;
            border-radius: 5px;
            color: var(--gray-dark);
        }
        .quiz-progress {
            background: #e0e0e0;
            border-radius: 10px;
            height: 10px;
            margin-bottom: 2rem;
            overflow: hidden;
        }
        .progress-bar {
            background: linear-gradient(45deg, var(--green-light), var(--yellow-accent));
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }
        .question-counter {
            text-align: center;
            color: var(--gray-dark);
            margin-bottom: 1rem;
            font-weight: bold;
        }
        .question {
            font-size: 1.4rem;
            margin-bottom: 2rem;
            color: var(--gray-dark);
            line-height: 1.6;
            font-weight: 600;
        }
        .question-image {
            width: 100%;
            max-width: 400px;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin: 1rem auto;
            display: block;
        }
        .answers {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .answer {
            background: #fff;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            font-size: 1.1rem;
            color: var(--gray-dark);
        }
        .answer:hover {
            background: var(--green-light);
            border-color: var(--yellow-accent);
            color: var(--green-dark);
        }
        .answer.selected {
            background: var(--green-medium);
            color: var(--white);
            border-color: var(--green-medium);
        }
        .answer.correct {
            background: var(--green-light);
            color: var(--green-dark);
            border-color: var(--green-light);
        }
        .answer.incorrect {
            background: #ef4444;
            color: var(--white);
            border-color: #ef4444;
        }
        .explanation {
            background: var(--green-soft);
            border-left: 4px solid var(--green-medium);
            padding: 1.2rem;
            margin: 1rem 0;
            border-radius: 8px;
            display: none;
            font-style: italic;
            color: var(--gray-dark);
        }
        .quiz-buttons {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            margin-top: 2rem;
        }
        .btn {
            padding: 1.2rem 2rem;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            flex: 1;
        }
        .btn-primary {
            background: var(--yellow-accent);
            color: var(--green-dark);
        }
        .btn-primary:hover {
            background: var(--green-light);
            color: var(--white);
        }
        .btn-secondary {
            background: var(--yellow-accent-alt);
            color: var(--green-dark);
        }
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        .results {
            text-align: center;
            display: none;
        }
        .score-circle {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            margin: 2rem auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: bold;
            color: white;
            position: relative;
            box-shadow: 0 10px 30px rgba(139,92,246,0.10);
        }
        .score-circle.score-excellent {
            background: linear-gradient(45deg, var(--green-light), var(--yellow-accent));
            color: var(--green-dark);
        }
        .score-circle.score-good {
            background: linear-gradient(45deg, var(--green-medium), var(--yellow-accent));
            color: var(--white);
        }
        .score-circle.score-average {
            background: linear-gradient(45deg, var(--yellow-accent), var(--green-soft));
            color: var(--green-dark);
        }
        .score-circle.score-poor {
            background: linear-gradient(45deg, #ef4444, var(--yellow-accent));
            color: var(--white);
        }
        .results h2 {
            color: var(--white);
            margin-bottom: 1rem;
            font-size: 2rem;
        }
        .results p {
            color: var(--gray-dark);
            margin-bottom: 2rem;
            font-size: 1.2rem;
        }
        .recommendations {
            background: #fff;
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem 0;
            text-align: left;
            border: 2px solid #e9ecef;
            color: var(--gray-dark);
        }
        .recommendations h3 {
            color: var(--green-light);
            margin-bottom: 1.5rem;
            font-size: 1.4rem;
        }
        .recommendations ul {
            color: var(--gray-dark);
            padding-left: 1.5rem;
        }
        .recommendations li {
            margin-bottom: 0.8rem;
            line-height: 1.5;
        }
        .share-results {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        .share-btn {
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            color: white;
            font-weight: bold;
            transition: transform 0.3s ease;
        }
        .share-btn:hover {
            transform: translateY(-2px);
        }
        .share-twitter { background: var(--yellow-accent); }
        .share-linkedin { background: #0077b5; }
        .share-facebook { background: var(--green-light); }
        .share-whatsapp { background: var(--green-light); }
        .share-reddit { background: #FF4500; }
        .share-instagram { background: #E1306C; }
        .back-btn {
            background: transparent;
            color: var(--yellow-accent);
            border: 2px solid var(--yellow-accent);
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            margin-bottom: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .back-btn:hover {
            background: var(--yellow-accent);
            color: var(--green-dark);
        }
        @media (max-width: 768px) {
            .quiz-title {
                font-size: 2rem;
            }
            .quiz-selection {
                grid-template-columns: 1fr;
            }
            .quiz-buttons {
                flex-direction: column;
            }
            .share-results {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="quiz-header">
            <h1 class="quiz-title">🌱 Quiz de Cultivo Indoor</h1>
            <p class="quiz-subtitle">Pon a prueba tus conocimientos sobre cultivo de cannabis indoor</p>
            <div class="share-results" style="margin-bottom: 2rem;">
                <a href="#" class="share-btn share-twitter" id="shareTwitterTop" target="_blank">🐦 X</a>
                <a href="#" class="share-btn share-facebook" id="shareFacebookTop" target="_blank">📘 Facebook</a>
                <a href="#" class="share-btn share-whatsapp" id="shareWhatsappTop" target="_blank">💬 WhatsApp</a>
                <a href="#" class="share-btn share-reddit" id="shareRedditTop" target="_blank">👽 Reddit</a>
                <a href="#" class="share-btn share-instagram" id="shareInstagramTop" target="_blank">📸 Instagram</a>
            </div>
        </div>

        <!-- Selección de Quiz -->
        <div id="quizSelection" class="quiz-selection">
            <div class="quiz-card" onclick="startQuiz('principiante')">
                <div class="quiz-icon">🌱</div>
                <h3>Principiante</h3>
                <p>Conceptos básicos: germinación, primeros pasos, equipamiento básico y cuidados iniciales.</p>
                <div class="quiz-meta">
                    <span class="difficulty principiante">Principiante</span>
                    <span>10 preguntas</span>
                </div>
            </div>

            <div class="quiz-card" onclick="startQuiz('intermedio')">
                <div class="quiz-icon">🪴</div>
                <h3>Intermedio</h3>
                <p>Nutrición, iluminación, control ambiental, poda y técnicas de entrenamiento.</p>
                <div class="quiz-meta">
                    <span class="difficulty intermedio">Intermedio</span>
                    <span>12 preguntas</span>
                </div>
            </div>

            <div class="quiz-card" onclick="startQuiz('avanzado')">
                <div class="quiz-icon">🌿</div>
                <h3>Avanzado</h3>
                <p>Genética, breeding, sistemas hidropónicos, control de plagas y enfermedades.</p>
                <div class="quiz-meta">
                    <span class="difficulty avanzado">Avanzado</span>
                    <span>15 preguntas</span>
                </div>
            </div>

            <div class="quiz-card" onclick="startQuiz('experto')">
                <div class="quiz-icon">🏆</div>
                <h3>Experto Grower</h3>
                <p>Técnicas avanzadas, optimización máxima, troubleshooting y cultivo comercial.</p>
                <div class="quiz-meta">
                    <span class="difficulty experto">Experto</span>
                    <span>20 preguntas</span>
                </div>
            </div>
        </div>

        <!-- Contenedor del Quiz -->
        <div id="quizContainer" class="quiz-container">
            <button class="back-btn" onclick="backToSelection()">← Volver a selección</button>
            
            <div class="quiz-info">
                <strong>💡 Tip:</strong> Lee cada pregunta cuidadosamente. Algunas tienen trucos comunes que cometen los cultivadores.
            </div>

            <div class="quiz-progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>

            <div class="question-counter" id="questionCounter"></div>
            <div class="question" id="question"></div>
            <div class="answers" id="answers"></div>
            <div class="explanation" id="explanation"></div>

            <div class="quiz-buttons">
                <button class="btn btn-secondary" id="prevBtn" onclick="prevQuestion()" disabled>Anterior</button>
                <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" disabled>Siguiente</button>
            </div>
        </div>

        <!-- Resultados -->
        <div id="results" class="results">
            <div class="score-circle" id="scoreCircle">
                <span id="scoreText"></span>
            </div>
            <h2 id="resultTitle"></h2>
            <p id="resultDescription"></p>
            
            <div class="recommendations" id="recommendations"></div>

            <div class="share-results">
                <a href="#" class="share-btn share-twitter" id="shareTwitter" target="_blank">🐦 X</a>
                <a href="#" class="share-btn share-facebook" id="shareFacebook" target="_blank">📘 Facebook</a>
                <a href="#" class="share-btn share-whatsapp" id="shareWhatsapp" target="_blank">💬 WhatsApp</a>
                <a href="#" class="share-btn share-reddit" id="shareReddit" target="_blank">👽 Reddit</a>
                <a href="#" class="share-btn share-instagram" id="shareInstagram" target="_blank">📸 Instagram</a>
            </div>

            <div style="margin-top: 2rem;">
                <button class="btn btn-primary" onclick="restartQuiz()">🔄 Repetir Quiz</button>
                <button class="btn btn-secondary" onclick="backToSelection()" style="margin-left: 1rem;">📚 Otros Quiz</button>
            </div>
        </div>
    </div>

    <script>
        // Base de datos de preguntas por nivel
        const quizData = {
            principiante: [
                {
                    question: "Según las guías técnicas, ¿cuál es el rango óptimo de pH para cultivo hidropónico o en coco?",
                    answers: ["6.0 - 6.8", "5.5 - 6.5", "6.5 - 7.0", "5.0 - 6.0"],
                    correct: 1,
                    explanation: "El rango óptimo de pH para hidroponía o coco es 5.5 - 6.5, permitiendo la mejor absorción de nutrientes."
                },
                {
                    question: "¿Cuál es el valor de EC recomendado para esquejes y plántulas según parámetros técnicos?",
                    answers: ["0.5 - 1.0 EC", "1.0 - 1.5 EC", "1.5 - 2.0 EC", "2.0 - 2.5 EC"],
                    correct: 0,
                    explanation: "Para esquejes y plántulas, el valor recomendado de EC es 0.5 - 1.0 EC para evitar estrés y quemaduras."
                },
                {
                    question: "Durante la propagación de esquejes/semillas, ¿qué temperatura se recomienda?",
                    answers: ["18-20°C", "22-24°C", "26-28°C", "30-32°C"],
                    correct: 1,
                    explanation: "La temperatura ideal para propagación es 22-24°C, favoreciendo el enraizamiento y germinación."
                },
                {
                    question: "¿Cuál es el VPD recomendado para la propagación según la tabla VPD?",
                    answers: ["0.4-0.6 kPa", "0.8-1.2 kPa", "1.2-1.6 kPa", "1.6-2.0 kPa"],
                    correct: 0,
                    explanation: "El VPD óptimo para propagación es 0.4-0.6 kPa, lo que favorece la transpiración y el enraizamiento."
                },
                {
                    question: "Según las guías de deficiencias, el amarillamiento de hojas viejas que avanza hacia arriba indica deficiencia de:",
                    answers: ["Fósforo", "Nitrógeno", "Potasio", "Calcio"],
                    correct: 1,
                    explanation: "El amarillamiento de hojas viejas que avanza hacia arriba es típico de deficiencia de nitrógeno."
                },
                {
                    question: "¿Qué humedad relativa se recomienda durante la propagación?",
                    answers: ["45-55% HR", "65-70% HR", "75-85% HR", "85-95% HR"],
                    correct: 2,
                    explanation: "Durante la propagación, la humedad ideal es 75-85% HR para evitar deshidratación."
                },
                {
                    question: "El síntoma de puntas y bordes de hojas amarillos/marrones indica deficiencia de:",
                    answers: ["Nitrógeno", "Fósforo", "Potasio", "Magnesio"],
                    correct: 2,
                    explanation: "Puntas y bordes amarillos/marrones suelen indicar deficiencia de potasio."
                },
                {
                    question: "¿Cuál es la temperatura recomendada para el calentamiento del sustrato durante la propagación?",
                    answers: ["20-22°C", "22-24°C", "24-26°C", "26-28°C"],
                    correct: 2,
                    explanation: "El sustrato debe mantenerse a 24-26°C para favorecer el desarrollo radicular."
                },
                {
                    question: "Según la tabla de deficiencias, el amarillamiento entre las venas de hojas viejas indica deficiencia de:",
                    answers: ["Hierro", "Magnesio", "Calcio", "Zinc"],
                    correct: 1,
                    explanation: "El amarillamiento entre venas de hojas viejas es típico de deficiencia de magnesio."
                },
                {
                    question: "¿Qué fase lunar es ideal para comenzar la germinación de semillas según el calendario lunar?",
                    answers: ["Luna llena", "Luna creciente", "Luna nueva", "Luna menguante"],
                    correct: 2,
                    explanation: "La luna nueva es la fase ideal para iniciar la germinación según el calendario lunar."
                }
            ],
            intermedio: [
                {
                    question: "¿Cuál es el valor de EC recomendado para floración media según parámetros técnicos?",
                    answers: ["2.0 - 2.5 EC", "2.2 - 2.7 EC", "1.5 - 2.0 EC", "2.5 - 3.0 EC"],
                    correct: 1,
                    explanation: "En floración media, el valor recomendado de EC es 2.2 - 2.7 EC para un desarrollo óptimo de flores."
                },
                {
                    question: "Durante el vegetativo medio (semanas 3-4), ¿qué VPD se recomienda?",
                    answers: ["0.7-0.9 kPa", "0.9-1.1 kPa", "1.1-1.3 kPa", "1.3-1.5 kPa"],
                    correct: 1,
                    explanation: "El VPD recomendado en vegetativo medio es 0.9-1.1 kPa para un crecimiento equilibrado."
                },
                {
                    question: "¿Qué intensidad de luz es recomendable para vegetativo medio?",
                    answers: ["Luz baja", "Luz media-alta", "Luz muy alta", "Luz mínima"],
                    correct: 1,
                    explanation: "En vegetativo medio se recomienda luz media-alta para estimular el crecimiento sin estrés."
                },
                {
                    question: "Para prevenir botrytis durante la floración, la humedad relativa nocturna debe mantenerse por debajo de:",
                    answers: ["50%", "45%", "40%", "35%"],
                    correct: 1,
                    explanation: "Para evitar botrytis, la humedad nocturna debe estar por debajo del 45%."
                },
                {
                    question: "¿Cuál es la diferencia de temperatura recomendada entre día y noche durante vegetativo tardío?",
                    answers: ["4-6°C", "6-8°C", "8-10°C", "10-12°C"],
                    correct: 1,
                    explanation: "La diferencia recomendada es de 6-8°C (26-28°C día, 18-20°C noche)."
                },
                {
                    question: "Los síntomas de hojas nuevas deformes y puntas ganchudas indican deficiencia de:",
                    answers: ["Potasio", "Calcio", "Magnesio", "Hierro"],
                    correct: 1,
                    explanation: "Hojas nuevas deformes y puntas ganchudas suelen indicar deficiencia de calcio."
                },
                {
                    question: "¿Qué plaga se caracteriza por punteado fino amarillo en hojas y telarañas finas?",
                    answers: ["Trips", "Mosca blanca", "Ácaros (araña roja)", "Pulgones"],
                    correct: 2,
                    explanation: "Los ácaros (araña roja) dejan punteado amarillo y telarañas finas en las hojas."
                },
                {
                    question: "¿Cómo se calcula el volumen de extracción necesario para un cultivo indoor?",
                    answers: ["Solo el volumen de la sala", "Volumen de la sala × renovaciones por hora deseadas", "Área de cultivo × altura", "Número de plantas × 10 m³/h"],
                    correct: 1,
                    explanation: "El volumen de extracción se calcula multiplicando el volumen de la sala por las renovaciones por hora deseadas."
                },
                {
                    question: "¿Qué fase lunar es óptima para hacer esquejes/clones?",
                    answers: ["Luna nueva", "Luna creciente (segundo cuarto)", "Luna llena", "Luna menguante"],
                    correct: 2,
                    explanation: "La luna llena es la fase óptima para hacer esquejes/clones."
                },
                {
                    question: "El margen de error recomendado para sensores de humedad en cultivos profesionales es:",
                    answers: ["<±1% HR", "<±3% HR", "<±5% HR", "<±7% HR"],
                    correct: 1,
                    explanation: "El margen de error recomendado es <±3% HR para sensores de humedad en cultivos profesionales."
                },
                {
                    question: "¿Qué deficiencia causa amarillamiento entre venas de hojas nuevas manteniendo las venas verdes?",
                    answers: ["Magnesio", "Hierro", "Zinc", "Manganeso"],
                    correct: 1,
                    explanation: "La deficiencia de hierro causa amarillamiento entre venas de hojas nuevas, manteniendo las venas verdes."
                },
                {
                    question: "Durante la floración tardía (semanas 7-9), ¿qué humedad se recomienda?",
                    answers: ["40-45% HR", "35-40% HR", "30-35% HR", "25-30% HR"],
                    correct: 1,
                    explanation: "En floración tardía, la humedad recomendada es 35-40% HR para evitar hongos."
                }
            ],
            avanzado: [
                {
                    question: "¿Cuál es la capacidad adicional recomendada para el equipo HVAC sobre el volumen de la sala?",
                    answers: ["10%", "15%", "20%", "25%"],
                    correct: 2,
                    explanation: "Se recomienda un 20% de capacidad adicional en HVAC para asegurar el control ambiental."
                },
                {
                    question: "Las variedades índicas requieren un ajuste de VPD de cuánto respecto al estándar?",
                    answers: ["+0.1 kPa", "-0.1 kPa", "+0.2 kPa", "-0.2 kPa"],
                    correct: 1,
                    explanation: "Las índicas requieren un ajuste de -0.1 kPa en el VPD respecto al estándar."
                },
                {
                    question: "Los cambios ambientales graduales no deben superar por día:",
                    answers: ["3% HR o 1°C", "5% HR o 2°C", "7% HR o 3°C", "10% HR o 4°C"],
                    correct: 1,
                    explanation: "No se deben superar 5% HR o 2°C de cambio ambiental por día para evitar estrés."
                },
                {
                    question: "¿Cuál es el ciclo de vida típico de los ácaros (araña roja)?",
                    answers: ["5-10 días", "7-14 días", "15-21 días", "21-28 días"],
                    correct: 1,
                    explanation: "El ciclo de vida de los ácaros es de 7-14 días, lo que requiere monitoreo frecuente."
                },
                {
                    question: "Para la deshumidificación durante floración tardía, ¿qué sistema de alerta se recomienda para desviaciones de parámetros?",
                    answers: [">5%", ">10%", ">15%", ">20%"],
                    correct: 1,
                    explanation: "Se recomienda un sistema de alerta para desviaciones superiores al 10% en parámetros críticos."
                },
                {
                    question: "El oídio se caracteriza por:",
                    answers: ["Moho gris-marrón en cogollos", "Manchas blancas polvorientas en hojas", "Raíces marrones y blandas", "Marchitamiento rápido"],
                    correct: 1,
                    explanation: "El oídio se identifica por manchas blancas polvorientas en hojas."
                },
                {
                    question: "La deficiencia de manganeso se diferencia de la de hierro por:",
                    answers: ["Afecta hojas viejas vs nuevas", "Causa manchas necróticas adicionales", "Solo afecta las venas", "No hay diferencia"],
                    correct: 1,
                    explanation: "La deficiencia de manganeso causa manchas necróticas adicionales, a diferencia del hierro."
                },
                {
                    question: "¿Qué tratamiento NO es efectivo contra la araña roja?",
                    answers: ["Acaricidas específicos", "Aceite de neem", "Jabón potásico", "Phytoseiulus persimilis"],
                    correct: 2,
                    explanation: "El jabón potásico no es efectivo contra la araña roja, a diferencia de los otros métodos."
                },
                {
                    question: "El pythium (pudrición de raíz) se trata principalmente con:",
                    answers: ["Fungicidas cúpricos", "Oxigenación y Trichoderma", "Bicarbonato de potasio", "Eliminación total de plantas"],
                    correct: 1,
                    explanation: "El tratamiento principal para pythium es la oxigenación y el uso de Trichoderma."
                },
                {
                    question: "¿Qué margen de error se recomienda para sensores de temperatura en cultivos profesionales?",
                    answers: ["<±0.3°C", "<±0.5°C", "<±0.7°C", "<±1.0°C"],
                    correct: 1,
                    explanation: "El margen de error recomendado es <±0.5°C para sensores de temperatura."
                },
                {
                    question: "Los trips se identifican por:",
                    answers: ["Telarañas finas", "Manchas plateadas y excrementos negros", "Melaza pegajosa", "Insectos blancos voladores"],
                    correct: 1,
                    explanation: "Los trips dejan manchas plateadas y excrementos negros en las hojas."
                },
                {
                    question: "¿Qué fase lunar es óptima para trasplantes?",
                    answers: ["Luna nueva", "Luna creciente (segundo cuarto)", "Luna llena", "Luna menguante"],
                    correct: 1,
                    explanation: "La luna creciente (segundo cuarto) es óptima para trasplantes."
                },
                {
                    question: "Para prevenir fusarium es fundamental:",
                    answers: ["Baja humedad", "Alta temperatura", "Sustrato limpio y buen drenaje", "Fertilización alta"],
                    correct: 2,
                    explanation: "Para prevenir fusarium es fundamental un sustrato limpio y buen drenaje."
                },
                {
                    question: "La deficiencia de zinc causa:",
                    answers: ["Amarillamiento uniforme", "Acortamiento de entrenudos y hojas retorcidas", "Puntas quemadas", "Manchas concéntricas"],
                    correct: 1,
                    explanation: "La deficiencia de zinc causa acortamiento de entrenudos y hojas retorcidas."
                },
                {
                    question: "¿Cuál es el tratamiento más efectivo para mosca del sustrato (fungus gnats)?",
                    answers: ["Acaricidas", "Bacillus thuringiensis israelensis (BTI)", "Fungicidas", "Jabón potásico"],
                    correct: 1,
                    explanation: "El tratamiento más efectivo es Bacillus thuringiensis israelensis (BTI)."
                }
            ],
            experto: [
                {
                    question: "¿Cuáles son los nutrientes principales NPK y por qué son fundamentales en el cultivo?",
                    answers: ["Nitrógeno, Fósforo, Potasio; esenciales para crecimiento y floración", "Calcio, Magnesio, Azufre; controlan el pH", "Hierro, Zinc, Boro; microelementos", "Sodio, Cloro, Cobre; no son esenciales"],
                    correct: 0,
                    explanation: "NPK significa Nitrógeno, Fósforo y Potasio, los tres nutrientes principales que regulan el crecimiento, floración y salud general de la planta."
                },
                {
                    question: "¿Cuál es el objetivo principal del sistema SCROG y cómo mejora la penetración de luz?",
                    answers: ["Aumentar la altura de la planta", "Maximizar la superficie de cogollos y mejorar la penetración de luz", "Reducir el consumo de agua", "Evitar el uso de fertilizantes"],
                    correct: 1,
                    explanation: "El sistema SCROG (Screen of Green) maximiza la superficie de cogollos y mejora la penetración de luz al distribuir las ramas de forma horizontal bajo una malla."
                },
                {
                    question: "¿Cuál es la concentración de CO₂ recomendada durante la floración con suplementación?",
                    answers: ["800-1000 ppm", "1200-1500 ppm", "1500-1800 ppm", "2000+ ppm"],
                    correct: 1,
                    explanation: "La concentración recomendada de CO₂ en floración con suplementación es 1200-1500 ppm."
                },
                {
                    question: "¿Qué es RDWC en hidroponía?",
                    answers: ["Rapid Deep Water Culture", "Recirculating Deep Water Culture", "Root Development Water Culture", "Recycled Drip Water Culture"],
                    correct: 1,
                    explanation: "RDWC significa Recirculating Deep Water Culture."
                },
                {
                    question: "En aeroponia de alta presión, ¿cada cuánto tiempo se activan los nebulizadores?",
                    answers: ["Cada 2-3 minutos", "Cada 5 minutos", "Cada 10 minutos", "Continuamente"],
                    correct: 1,
                    explanation: "En aeroponia de alta presión, los nebulizadores se activan cada 5 minutos."
                },
                {
                    question: "¿Cuál es la mejor estrategia de iluminación para floración?",
                    answers: ["Luz azul predominante", "Luz roja predominante", "Espectro completo con luz intensa", "Solo luz verde"],
                    correct: 2,
                    explanation: "La mejor estrategia es espectro completo con luz intensa."
                },
                {
                    question: "¿Qué significa DLI en iluminación?",
                    answers: ["Direct Light Index", "Daily Light Integral (integral de luz diaria)", "Distributed Light Integration", "Deep Light Intensity"],
                    correct: 1,
                    explanation: "DLI significa Daily Light Integral (integral de luz diaria)."
                },
                {
                    question: "¿Cuál es la diferencia principal entre cultivo en tierra y en coco?",
                    answers: ["El coco crece más rápido", "El coco permite mayor control nutricional", "La tierra es más cara", "No hay diferencias"],
                    correct: 1,
                    explanation: "El coco permite mayor control nutricional respecto a la tierra."
                },
                {
                    question: "¿Qué es el 'flushing' o lavado de raíces?",
                    answers: ["Limpiar las hojas con agua", "Regar solo con agua para eliminar nutrientes acumulados", "Cambiar el sustrato", "Aplicar más fertilizante"],
                    correct: 1,
                    explanation: "El flushing es regar solo con agua para eliminar nutrientes acumulados."
                },
                {
                    question: "¿Qué busca conseguir la técnica MainLining?",
                    answers: ["Múltiples colas principales simétricas", "Una sola cola central grande", "Crecimiento horizontal", "Floración acelerada"],
                    correct: 0,
                    explanation: "MainLining busca múltiples colas principales simétricas."
                },
                {
                    question: "¿Cuál es un ejemplo de bacteria promotora del crecimiento vegetal?",
                    answers: ["E.coli", "Pseudomonas", "Salmonella", "Streptococcus"],
                    correct: 1,
                    explanation: "Pseudomonas es una bacteria promotora del crecimiento vegetal."
                },
                {
                    question: "¿Cuál es la temperatura ideal para la zona radicular?",
                    answers: ["15-18°C", "18-24°C", "24-28°C", "28-32°C"],
                    correct: 1,
                    explanation: "La temperatura ideal para la zona radicular es 18-24°C."
                },
                {
                    question: "¿Qué miden los tensiómetros en cultivo de precisión?",
                    answers: ["Humedad del aire", "Tensión hídrica del sustrato", "Presión atmosférica", "Concentración de nutrientes"],
                    correct: 1,
                    explanation: "Los tensiómetros miden la tensión hídrica del sustrato."
                },
                {
                    question: "¿Cuándo es más efectivo aplicar CO₂ suplementario?",
                    answers: ["Solo durante la noche", "Durante las horas de luz", "Las 24 horas", "Solo al amanecer"],
                    correct: 1,
                    explanation: "El CO₂ suplementario es más efectivo durante las horas de luz."
                },
                {
                    question: "En la técnica SoG (Sea of Green), ¿cuál es la densidad máxima recomendada?",
                    answers: ["10-15 plantas/m²", "16-25 plantas/m²", "25-30 plantas/m²", "30-40 plantas/m²"],
                    correct: 1,
                    explanation: "La densidad máxima recomendada en SoG es 16-25 plantas/m²."
                },
                {
                    question: "¿Qué son las IBL en genética cannábica?",
                    answers: ["Líneas híbridas F1", "Líneas consanguíneas estables", "Variedades landrace", "Líneas polihíbridas"],
                    correct: 1,
                    explanation: "IBL son líneas consanguíneas estables."
                },
                {
                    question: "¿Cuál es el efecto principal de la luz UV-B en las plantas?",
                    answers: ["Acelera el crecimiento", "Aumenta la producción de tricomas", "Mejora la absorción de nutrientes", "Reduce el tiempo de floración"],
                    correct: 1,
                    explanation: "La luz UV-B aumenta la producción de tricomas."
                },
                {
                    question: "¿Cuántas renovaciones de aire necesita un cuarto de cultivo?",
                    answers: ["Pocas renovaciones", "Renovación constante moderada-alta", "Solo renovación nocturna", "Una renovación por día"],
                    correct: 1,
                    explanation: "Se recomienda renovación constante moderada-alta de aire en el cuarto de cultivo."
                },
                {
                    question: "¿Qué es el 'stretch' en cannabis?",
                    answers: ["Una enfermedad", "Crecimiento acelerado al inicio de floración", "Una técnica de poda", "Un tipo de sustrato"],
                    correct: 1,
                    explanation: "El stretch es el crecimiento acelerado al inicio de la floración."
                },
                {
                    question: "¿Cuál es el mejor momento para cosechar según los tricomas?",
                    answers: ["Cuando están transparentes", "Cuando están lechosos/turbios", "Cuando están todos ámbar", "No importa el color"],
                    correct: 1,
                    explanation: "El mejor momento para cosechar es cuando los tricomas están lechosos/turbios."
                }
            ]
        };

        // Estado del quiz
        let currentQuiz = null;
        let currentQuestions = [];
        let currentIndex = 0;
        let userAnswers = [];
        let score = 0;

        // Elementos del DOM
        const quizSelection = document.getElementById('quizSelection');
        const quizContainer = document.getElementById('quizContainer');
        const questionCounter = document.getElementById('questionCounter');
        const questionEl = document.getElementById('question');
        const answersEl = document.getElementById('answers');
        const explanationEl = document.getElementById('explanation');
        const progressBar = document.getElementById('progressBar');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const resultsEl = document.getElementById('results');
        const scoreCircle = document.getElementById('scoreCircle');
        const scoreText = document.getElementById('scoreText');
        const resultTitle = document.getElementById('resultTitle');
        const resultDescription = document.getElementById('resultDescription');
        const recommendations = document.getElementById('recommendations');

        function startQuiz(level) {
            currentQuiz = level;
            currentQuestions = quizData[level];
            currentIndex = 0;
            userAnswers = [];
            score = 0;
            quizSelection.style.display = 'none';
            quizContainer.style.display = 'block';
            resultsEl.style.display = 'none';
            renderQuestion();
        }

        function renderQuestion() {
            const q = currentQuestions[currentIndex];
            questionCounter.textContent = `Pregunta ${currentIndex + 1} de ${currentQuestions.length}`;
            questionEl.textContent = q.question;
            answersEl.innerHTML = '';
            explanationEl.style.display = 'none';
            progressBar.style.width = `${((currentIndex + 1) / currentQuestions.length) * 100}%`;
            q.answers.forEach((ans, i) => {
                const btn = document.createElement('button');
                btn.className = 'answer';
                btn.textContent = ans;
                btn.onclick = () => selectAnswer(i);
                if (userAnswers[currentIndex] !== undefined) {
                    btn.disabled = true;
                    if (i === q.correct) btn.classList.add('correct');
                    if (i === userAnswers[currentIndex] && i !== q.correct) btn.classList.add('incorrect');
                }
                answersEl.appendChild(btn);
            });
            prevBtn.disabled = currentIndex === 0;
            nextBtn.disabled = userAnswers[currentIndex] === undefined;
        }

        function selectAnswer(i) {
            if (userAnswers[currentIndex] !== undefined) return;
            userAnswers[currentIndex] = i;
            const q = currentQuestions[currentIndex];
            if (i === q.correct) score++;
            renderQuestion();
            explanationEl.textContent = q.explanation;
            explanationEl.style.display = 'block';
            nextBtn.disabled = false;
        }

        function nextQuestion() {
            if (currentIndex < currentQuestions.length - 1) {
                currentIndex++;
                renderQuestion();
            } else {
                showResults();
            }
        }

        function prevQuestion() {
            if (currentIndex > 0) {
                currentIndex--;
                renderQuestion();
            }
        }

        function showResults() {
            quizContainer.style.display = 'none';
            resultsEl.style.display = 'block';
            let percent = Math.round((score / currentQuestions.length) * 100);
            scoreText.textContent = `${score} / ${currentQuestions.length}`;
            if (percent >= 90) {
                scoreCircle.className = 'score-circle score-excellent';
                resultTitle.textContent = '¡Excelente!';
                resultDescription.textContent = '¡Eres un maestro del cultivo indoor!';
            } else if (percent >= 70) {
                scoreCircle.className = 'score-circle score-good';
                resultTitle.textContent = '¡Muy bien!';
                resultDescription.textContent = 'Tienes muy buenos conocimientos, sigue perfeccionando tu técnica.';
            } else if (percent >= 50) {
                scoreCircle.className = 'score-circle score-average';
                resultTitle.textContent = '¡Bien!';
                resultDescription.textContent = 'Tienes una buena base, pero puedes mejorar.';
            } else {
                scoreCircle.className = 'score-circle score-poor';
                resultTitle.textContent = '¡Ánimo!';
                resultDescription.textContent = 'Sigue estudiando y practicando para mejorar tus resultados.';
            }
            recommendations.innerHTML = '<h3>Recomendaciones:</h3><ul><li>Revisa las guías de la Wiki para reforzar tus conocimientos.</li><li>Practica con diferentes escenarios de cultivo.</li><li>Consulta foros y comunidades para aprender de otros cultivadores.</li></ul>';

            // Lógica para compartir en redes sociales
            const quizUrl = window.location.origin + window.location.pathname;
            const shareText = `¡He sacado ${score} de ${currentQuestions.length} en el Quiz de Cultivo Indoor de GrowCalculator! 🌱\n¿Te atreves a superarme?`;
            const fbShareUrl = isMobile()
              ? `https://m.facebook.com/sharer.php?u=${encodeURIComponent(quizUrl)}`
              : `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(quizUrl)}&quote=${encodeURIComponent(shareText)}`;
            if (document.getElementById('shareFacebook')) {
                document.getElementById('shareFacebook').href = fbShareUrl;
            }
            if (document.getElementById('shareTwitter')) {
                document.getElementById('shareTwitter').href = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(quizUrl)}`;
            }
            if (document.getElementById('shareWhatsapp')) {
                document.getElementById('shareWhatsapp').href = `https://wa.me/?text=${encodeURIComponent(shareText + ' ' + quizUrl)}`;
            }
            if (document.getElementById('shareReddit')) {
                document.getElementById('shareReddit').href = `https://www.reddit.com/submit?url=${encodeURIComponent(quizUrl)}&title=${encodeURIComponent(shareText)}`;
            }
            if (document.getElementById('shareInstagram')) {
                document.getElementById('shareInstagram').onclick = function(e) {
                    e.preventDefault();
                    navigator.clipboard.writeText(shareText + ' ' + quizUrl);
                    alert('¡Texto copiado! Ahora puedes pegarlo en tu historia o mensaje de Instagram.');
                };
            }
        }

        function backToSelection() {
            quizSelection.style.display = 'grid';
            quizContainer.style.display = 'none';
            resultsEl.style.display = 'none';
        }

        function restartQuiz() {
            startQuiz(currentQuiz);
        }

        function isMobile() {
          return /Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent);
        }

        // Compartir arriba (pantalla de selección)
        document.addEventListener('DOMContentLoaded', function() {
            const quizUrl = window.location.origin + window.location.pathname;
            const shareText = '¡Pon a prueba tus conocimientos sobre cultivo indoor en el Quiz de GrowCalculator! 🌱';
            const fbShareUrlTop = isMobile()
              ? `https://m.facebook.com/sharer.php?u=${encodeURIComponent(quizUrl)}`
              : `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(quizUrl)}&quote=${encodeURIComponent(shareText)}`;
            if (document.getElementById('shareFacebookTop')) {
                document.getElementById('shareFacebookTop').href = fbShareUrlTop;
            }
            if (document.getElementById('shareTwitterTop')) {
                document.getElementById('shareTwitterTop').href = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(quizUrl)}`;
            }
            if (document.getElementById('shareWhatsappTop')) {
                document.getElementById('shareWhatsappTop').href = `https://wa.me/?text=${encodeURIComponent(shareText + ' ' + quizUrl)}`;
            }
            if (document.getElementById('shareRedditTop')) {
                document.getElementById('shareRedditTop').href = `https://www.reddit.com/submit?url=${encodeURIComponent(quizUrl)}&title=${encodeURIComponent(shareText)}`;
            }
            if (document.getElementById('shareInstagramTop')) {
                document.getElementById('shareInstagramTop').onclick = function(e) {
                    e.preventDefault();
                    navigator.clipboard.writeText(shareText + ' ' + quizUrl);
                    alert('¡Texto copiado! Ahora puedes pegarlo en tu historia o mensaje de Instagram.');
                };
            }
        });
    </script>
</body>